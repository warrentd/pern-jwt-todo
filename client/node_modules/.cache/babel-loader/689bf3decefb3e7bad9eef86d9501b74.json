{"ast":null,"code":"import _regeneratorRuntime from\"/Users/trwarren/Projects/pern-jwt-todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/trwarren/Projects/pern-jwt-todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/trwarren/Projects/pern-jwt-todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Fragment,useState,useEffect}from'react';import{toast}from'react-toastify';//components\nimport InputTodo from'./todolist/InputTodo';import ListTodos from'./todolist/ListTodo';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var Dashboard=function Dashboard(_ref){var setAuth=_ref.setAuth;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),allTodos=_useState4[0],setAllTodos=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),todosChange=_useState6[0],setTodosChange=_useState6[1];var getProfile=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,parseResponse;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch('/dashboard/',{method:'GET',headers:{token:localStorage.token}});case 3:response=_context.sent;_context.next=6;return response.json();case 6:parseResponse=_context.sent;setAllTodos(parseResponse);setName(parseResponse[0].user_name);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.error(_context.t0.message);case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function getProfile(){return _ref2.apply(this,arguments);};}();var logout=function logout(e){e.preventDefault();localStorage.removeItem('token');setAuth(false);toast.success('Logout Successful');};//runs the useEffect function to prevent page refresh\nuseEffect(function(){getProfile();//notices that the state has changed and gets all todos and profile information again\nsetTodosChange(false);//sets Todos state back to false so that when another change happens, it reruns the useEffect function\n},[todosChange]);return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex mt-5 justify-content-around\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[name,\"'s Todo List\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:function onClick(e){return logout(e);},children:\"Logout\"})]}),/*#__PURE__*/_jsx(InputTodo,{setTodosChange:setTodosChange}),/*#__PURE__*/_jsx(ListTodos,{allTodos:allTodos,setTodosChange:setTodosChange})]});};export default Dashboard;","map":{"version":3,"sources":["/Users/trwarren/Projects/pern-jwt-todo/client/src/components/dashboard/Dashboard.js"],"names":["React","Fragment","useState","useEffect","toast","InputTodo","ListTodos","Dashboard","setAuth","name","setName","allTodos","setAllTodos","todosChange","setTodosChange","getProfile","fetch","method","headers","token","localStorage","response","json","parseResponse","user_name","console","error","message","logout","e","preventDefault","removeItem","success"],"mappings":"yeAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,QAA1B,CAAoCC,SAApC,KAAqD,OAArD,CACA,OAASC,KAAT,KAAsB,gBAAtB,CAEA;AACA,MAAOC,CAAAA,SAAP,KAAsB,sBAAtB,CACA,MAAOC,CAAAA,SAAP,KAAsB,qBAAtB,C,wFAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,MAAiB,IAAdC,CAAAA,OAAc,MAAdA,OAAc,CAC/B,cAAwBN,QAAQ,CAAC,EAAD,CAAhC,wCAAOO,IAAP,eAAaC,OAAb,eACA,eAAgCR,QAAQ,CAAC,EAAD,CAAxC,yCAAOS,QAAP,eAAiBC,WAAjB,eACA,eAAsCV,QAAQ,CAAC,KAAD,CAA9C,yCAAOW,WAAP,eAAoBC,cAApB,eAEA,GAAMC,CAAAA,UAAU,2FAAG,oMAEYC,CAAAA,KAAK,CAAC,aAAD,CAAgB,CACxCC,MAAM,CAAE,KADgC,CAExCC,OAAO,CAAE,CAAEC,KAAK,CAAEC,YAAY,CAACD,KAAtB,CAF+B,CAAhB,CAFjB,QAELE,QAFK,qCAOiBA,CAAAA,QAAQ,CAACC,IAAT,EAPjB,QAOLC,aAPK,eAQXX,WAAW,CAACW,aAAD,CAAX,CACAb,OAAO,CAACa,aAAa,CAAC,CAAD,CAAb,CAAiBC,SAAlB,CAAP,CATW,iFAYXC,OAAO,CAACC,KAAR,CAAc,YAAIC,OAAlB,EAZW,qEAAH,kBAAVZ,CAAAA,UAAU,2CAAhB,CAgBA,GAAMa,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAACC,CAAD,CAAO,CAClBA,CAAC,CAACC,cAAF,GACAV,YAAY,CAACW,UAAb,CAAwB,OAAxB,EACAvB,OAAO,CAAC,KAAD,CAAP,CACAJ,KAAK,CAAC4B,OAAN,CAAc,mBAAd,EACH,CALD,CAOA;AACA7B,SAAS,CAAC,UAAM,CACZY,UAAU,GAAI;AACdD,cAAc,CAAC,KAAD,CAAd,CAAuB;AAC1B,CAHQ,CAGN,CAACD,WAAD,CAHM,CAAT,CAKA,mBACA,MAAC,QAAD,yBACI,aAAK,SAAS,CAAC,oCAAf,wBACI,sBAAKJ,IAAL,kBADJ,cAEI,eACI,SAAS,CAAC,iBADd,CAEI,OAAO,CAAE,iBAAAoB,CAAC,QAAID,CAAAA,MAAM,CAACC,CAAD,CAAV,EAFd,oBAFJ,GADJ,cASI,KAAC,SAAD,EAAW,cAAc,CAAEf,cAA3B,EATJ,cAUI,KAAC,SAAD,EAAW,QAAQ,CAAEH,QAArB,CAA+B,cAAc,CAAEG,cAA/C,EAVJ,GADA,CAcH,CAhDD,CAkDA,cAAeP,CAAAA,SAAf","sourcesContent":["import React, { Fragment, useState, useEffect } from 'react';\nimport { toast } from 'react-toastify';\n\n//components\nimport InputTodo from './todolist/InputTodo';\nimport ListTodos from './todolist/ListTodo';\n\nconst Dashboard = ({ setAuth }) => {\n    const [name, setName] = useState('');\n    const [allTodos, setAllTodos] = useState([]);\n    const [todosChange, setTodosChange] = useState(false);\n\n    const getProfile = async () => {\n        try {\n            const response = await fetch('/dashboard/', {\n                method: 'GET',\n                headers: { token: localStorage.token }\n            });\n\n            const parseResponse = await response.json();\n            setAllTodos(parseResponse);\n            setName(parseResponse[0].user_name);\n\n        } catch (err) {\n            console.error(err.message);\n        }\n    }\n\n    const logout = (e) => {\n        e.preventDefault();\n        localStorage.removeItem('token');\n        setAuth(false);\n        toast.success('Logout Successful');\n    };\n\n    //runs the useEffect function to prevent page refresh\n    useEffect(() => {\n        getProfile(); //notices that the state has changed and gets all todos and profile information again\n        setTodosChange(false); //sets Todos state back to false so that when another change happens, it reruns the useEffect function\n    }, [todosChange]);\n\n    return (\n    <Fragment>\n        <div className='d-flex mt-5 justify-content-around'>\n            <h2>{name}'s Todo List</h2>\n            <button \n                className='btn btn-primary'\n                onClick={e => logout(e)}>\n                Logout\n            </button> \n        </div>\n        <InputTodo setTodosChange={setTodosChange}/> \n        <ListTodos allTodos={allTodos} setTodosChange={setTodosChange}/>\n    </Fragment>\n    );\n};\n\nexport default Dashboard;"]},"metadata":{},"sourceType":"module"}